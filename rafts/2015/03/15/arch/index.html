<!DOCTYPE html>
<html>
   <head>
      <link rel="stylesheet" href="//yandex.st/highlightjs/8.0/styles/github.min.css">
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css" />
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css" />
      <!--link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/menus-min.css" /-->
      <link rel="stylesheet" type="text/css" href="/blog/css/default.css" />
      <link rel="alternate" type="application/rss+xml" title="RSS" href="/blog/feed.xml" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta charset="utf-8">
      <script src="//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="/blog/js/highlight.pack.js"></script>

      <script type="text/javascript">
         WebFont.load({
            google: {
               families: ["Lato:400,300,700,400italic:latin", "Source+Code+Pro:400,700:latin"]
            }
         });
      </script>
      <script>hljs.initHighlightingOnLoad();</script>
      <script type="text/javascript">
            MathJax.Hub.Config({
               tex2jax: {
                  inlineMath: [],
                  displayMath: [],
               }
            });
      </script>
      <title>Learning from Arch Linux</title>
   </head>
   <body>
      <header>
  <div class="pure-menu pure-menu-horizontal pure-g">
    <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 pure-u-lg-3-5">
      <div class="pure-u-1-6 pure-u-md-1-2 pure-u-lg-1-2">
        <a href="/blog/" class="site-title pure-menu-heading pure-u-1">&nbsp;</a>
      </div>
      <div class="sites pure-u-5-6 pure-u-md-1-2 pure-u-lg-1-2">
        <ul class="pure-menu-list">
          <li class="pure-menu-item">
            <a href="/blog/" class="l-blog pure-menu-link" title="Inicio"><i class="fa fa-home"></i></a>
          </li>
          <li class="pure-menu-item">
            <a href="/foro" class="l-foro pure-menu-link" title="Foro"><i class="fa fa-comments"></i></a>
          </li>
          <li class="pure-menu-item">
            <a href="/blog/resources" class="l-res pure-menu-link" title="Recursos"><i class="fa fa-bookmark"></i></a>
          </li>
          <li class="pure-menu-item">
            <a href="https://github.com/dgiim/blog" title="GitHub" class="pure-menu-link"><i class="fa fa-github"></i></a>
          </li>
          <li class="pure-menu-item">
            <a href="https://twitter.com/dgiimBlog" title="Twitter" class="pure-menu-link"><i class="fa fa-twitter"></i></a>
          </li>
        </ul>
      </div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
  </div>
</header>

      <article>
  

  <div class="pure-g">
  <div class="pure-u-1">
    <h1>
      <a href="/blog/2015/03/15/arch" class="pure-g">
        <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
        <div class="pure-u-22-24 pure-u-md-22-24 pure-u-lg-3-5">
          Learning from Arch Linux
        </div>
        <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
      </a>
    </h1>

    <div class="post-data pure-g">
      <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
      <div class="pure-u-22-24 pure-u-md-22-24 pure-u-lg-3-5">
        <div class="pure-g">
          <div class="author pure-u-1 pure-u-md-2-3 pure-u-lg-3-4">
            
            
              
                
                 
                <a href="http://github.com/NCordon">Ignacio Cordón</a>
              
            
            
            <div class="date">
              15-03-2015
            </div>
          </div>

          <div class="edit-button pure-u-0 pure-u-md-1-3 pure-u-lg-1-4">
            <a class="edit" href="https://github.com/dgiim/blog/edit/gh-pages/_posts/2015-3-15-arch.md">
              <i class="fa fa-pencil"></i> Editar
            </a>
          </div>
        </div>
      </div>
      <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
    </div>
  </div>
</div>

<div class="post-content pure-g">

  <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>

  <div class="pure-u-22-24 pure-u-md-22-24 pure-u-lg-3-5">

    <p>Arch is an open source, <em>rolling release</em> distribution. It’s a Linux distribution well-known for its extremely complete wiki. Almost certainly, you should have reached an Arch’s wiki entry searching for troubleshooting about other  distributions.</p>

<p>If you’re wiling to enlarge your knowledge about Linux, it’s highly recommended trying to install Arch or another terminal-installation based distro at least once, because GUI Linux installers made that task easier. On the contrary, Arch installation is completely based on terminal commands.</p>

<p>You can download Arch from <a href="https://www.archlinux.org/download/">here</a>.</p>

<p><a href="https://wiki.archlinux.org/index.php/Beginners%27_guide">This</a> has been the guide followed to install Arch to a partition in my hard drive. You could also try it in a virtual machine!</p>

<p>Beforehand you must know you’re gonna need an Internet Connection to install Arch. The main goal of installing Arch is learning, so if you follow my steps strictly to the letter, you aren’t gonna learn as much as if you found your own path. This would be handy in case you got stuck in a step.</p>

<!--more-->

<h2 id="booting-from-a-usb-in-uefi">Booting from a usb in UEFI</h2>

<p>The image of Arch can be copied to an usb and made booteable by running <code>dd</code> as it follows:</p>

<pre><code class="language-bash">dd bs=4M if=/path/to/archlinux.iso of=/dev/sdx &amp;&amp; sync
</code></pre>

<p>It would be sufficient to boot with Secure Boot disabled (<a href="http://fdavidcl.me/tagged/uefi">Here</a> you’ve got some useful information about it).</p>

<h2 id="installation">Installation</h2>

<p>Once in the installer, you’ll get a terminal.</p>

<h3 id="pre-downloading">Pre-downloading</h3>

<p>As usual, keyboard layout may not be the desired one, so you’ll have to change it by typing:</p>

<pre><code class="language-bash">loadkeys layout
</code></pre>

<p>where possibles values for layout can be consulted in the wiki. </p>

<p>In my case, I configured a wifi conection with <code>wifi-menu</code>, but configuring <code>dhcpcd</code> and its configuration file in <code>/etc</code> would be sufficient.</p>

<p>Now it’s time to prepare partitions. At least a partition <code>/</code> is needed, but you could also split these partitions from <code>/var</code>, <code>/home</code>, <code>swap</code> partition… In order to do that I used parted, as explained in Arch’s wiki, but <code>fdisk</code> and <code>gdisk</code> could also fit that purpose.</p>

<p>I needed to do a triple boot, because I also have Widnows and Ubuntu installed in the same machine, and I wanted to keep Ubuntu’s bootloader, so once I created <code>/</code> partition, I mounted both this partition and EFI’s one in a folder in <code>mnt</code>:</p>

<pre><code class="language-bash">mkdir -p /mnt/boot/efi
mount /dev/sdxB /mnt/boot/efi
</code></pre>

<p>where <code>-p</code> option creates also parent directories if they don’t exist, and <code>sdxB</code> was my EFI partition.</p>

<h3 id="system-installation">System installation</h3>

<p>Can be made typing:</p>

<pre><code class="language-bash">pacstrap -i /mnt
pacstrap -i /mnt base base-devel
</code></pre>

<p>This is the step that needs internet connection.</p>

<h3 id="generation-of-fstab">Generation of fstab</h3>

<p>In order to mount the <code>/</code> and the <code>/boot/efi</code>, you should either execute:</p>

<pre><code class="language-bash">genfstab -U -p /mnt &gt;&gt; /mnt/etc/fstab
</code></pre>

<p>or manually configure <code>/mnt/etc/fstab</code>.</p>

<p>Up to this point, there is a <code>bash</code> <a href="https://github.com/analca3/Install-Archlinux-Script/blob/master/Install-Archlinux-Script.sh">script</a> that does all the donkey work, thanks to <a href="https://github.com/analca3">@analca3</a>.</p>

<h3 id="configuring-the-system">Configuring the system</h3>

<p>We have to do a <code>chroot</code> now to configure the system.
If we want to do it through the current terminal:</p>

<pre><code class="language-bash">arch-chroot /mnt /bin/bash
</code></pre>

<p>But in case you need to complete the installation through other operative system (Linux preferred) you can mount the created Arch partition inside that system, and do a <code>chroot</code> (or equivalent), with <code>sdxA</code> the partition in which Arch
is stored:</p>

<pre><code class="language-bash">mkdir arch
cd arch
sudo mount /dev/sdxA .
mount -t proc proc proc/
mount -t sysfs sys sys/
mount -o bind /dev dev/
mount -t devpts pts dev/pts/
mount --rbind /run run/
chroot . /bin/bash
</code></pre>

<p>Once done the chroot:</p>

<p>If you want more information, as usual, in the Arch’s wiki there’s plenty of information: <a href="https://wiki.archlinux.org/index.php/Change_root">here</a> and <a href="https://shafeeqk.wordpress.com/2012/07/02/archlinux-chroot/">here</a>.</p>

<dl>
  <dt>Tip!</dt>
  <dd>If you want to have internet connection in the chrooted system:</dd>
  <dd>
    <pre><code class="language-bash">cp -L /etc/resolv.conf ./arch/etc/resolv.conf
</code></pre>
  </dd>
</dl>

<p><a href="http://superuser.com/questions/111152/whats-the-proper-way-to-prepare-chroot-to-recover-a-broken-linux-installation">Source</a></p>

<p>We need to install, using <code>pacman -S &lt;packages&gt;</code>:</p>

<ul>
  <li>
    <p><code>iw</code>, that is used to find Wifi’s devices names.</p>
  </li>
  <li>
    <p><code>wpa_supplicant</code>, that is used to connect to WPA networks</p>
  </li>
  <li>
    <p><code>dialog</code>, which is utilized to display dialog boxes in shells.</p>
  </li>
</ul>

<p>Now with <code>wifi-menu</code> we can connect to an interface.</p>

<h3 id="setting-up-things">Setting up things</h3>

<h4 id="users">Users</h4>

<p>It’s highly advised to change <code>root</code> password:</p>

<pre><code class="language-bash">passwd
</code></pre>

<p>If we desire to create a new admin account we can do it by typing:</p>

<pre><code class="language-bash">useradd -m -G wheel -s /bin/bash username
</code></pre>

<p>The group <code>wheel</code> is normally used to give access to <code>sudo</code> and <code>su</code>. We gotta add it to the <code>sudoers</code> file too, uncommenting the line:</p>

<pre><code class="language-bash">%wheel ALL=(ALL) ALL
</code></pre>

<h4 id="keymap-and-locale">Keymap and locale</h4>

<p>We have to change the keymap in order not to have problems typing the passwords when we restart the system. This’ll do it:</p>

<pre><code class="language-bash">echo "KEYMAP=es\\nFONT=lat9w-16" &gt;&gt; /etc/vconsole.conf
</code></pre>

<p>To change the locale, we have to uncomment the line corresponding to our locale in <code>/etc/locale.gen</code>, and we need to compile the locale file selected by typing <code>locale-gen</code>. The last step concerning to locales is choosing the language: <code>echo LANG=en_US.UTF-8 &gt; /etc/locale.conf</code> and exporting the variable of that language: <code>export LANG=en_US.UTF-8</code> </p>

<h3 id="time-and-cpu-clock">Time and CPU clock</h3>
<p>To set the timezone and the clock:</p>

<pre><code class="language-bash">ln -s /usr/share/zoneinfo/Europe/Madrid /etc/localtime
hwclock --systohc --utc
</code></pre>

<p>Again, there’s a <a href="https://github.com/analca3/Install-Archlinux-Script/blob/master/After-chroot.sh">script</a> made by <a href="https://github.com/analca3">analca3</a> that does some of this process, but I insist in the fact that there’s no point in deciding to install Arch if you don’t realize how things gotta be set up before being able to use the system in a normal way.</p>

<h4 id="hostname">Hostname</h4>

<p>To select a hostname name:</p>

<pre><code class="language-bash">echo myhostname &gt; /etc/hostname
</code></pre>

<p>And we modify both lines in <code>/etc/hosts</code> to change the hostname. </p>

<h3 id="graphical-interface">Graphical interface</h3>

<p>We are gonna install <a href="http://www.x.org/wiki/">Xorg</a>, the usual windows management system in UNIX systems. And a display manager so that we’ll have a running graphical interface in which we could work. In my case I had hybrid graphics with an Intel integrated GPU and a Nvidia discrete GPU:</p>

<pre><code class="language-bash">pacman -S xorg-server xorg-server-utils xorg-init
pacman -Ss xf86-video-intel nvidia xorg-xrandr
pacman -S gnome
</code></pre>

<p>and</p>

<pre><code class="language-bash"># nano /etc/X11/xorg.conf

Section "ServerLayout"
    Identifier "layout"
    Screen 0 "nvidia"
    Inactive "intel"
EndSection

Section "Device"
    Identifier "nvidia"
    Driver "nvidia"
    BusID "PCI:PCI address determined earlier"
    # e.g. BusID "PCI:1:0:0"
EndSection

Section "Screen"
    Identifier "nvidia"
    Device "nvidia"
    Option "AllowEmptyInitialConfiguration"
EndSection

Section "Device"
    Identifier "intel"
    Driver "modesetting"
    Option "AccelMethod"  "none"
EndSection

Section "Screen"
    Identifier "intel"
    Device "intel"
EndSection
</code></pre>

<p>where PCI address determined earlier can be found in the output of <code>lspci</code> in format <code>01:00.0</code> which needs to be converted to <code>1:0:0</code>.</p>

<p>This configuration has to be changed permanently in <code>/etc/gdm/Init/Default</code> by adding, before the line <code>exit 0</code>:</p>

<pre><code class="language-bash">xrandr --setprovideroutputsource modesetting NVIDIA-0
xrandr --auto
</code></pre>

<h3 id="network-manager">Network Manager</h3>

<p>To install classic Gnome Network Manager the steps below are suggested:</p>

<pre><code class="language-bash">sudo pacman -S networkmanager network-manager-applet gnome-keyring
sudo systemctl enable NetworkManager.service
sudo systemctl disable dhcpcd.service
sudo systemctl disable dhcpcd@.service
sudo systemctl stop dhcpcd.service
sudo systemctl stop dhcpcd@.service
gpasswd -a USERNAME network
sudo systemctl start wpa_supplicant.service
sudo systemctl start NetworkManager.service
</code></pre>

<p>The commands above make Network Manager start on boot, stop and disable starting on boot of dhcpd in order for NetworkManager to be the handler of that function.</p>

<p>That’ll pretty much do it.</p>

<h2 id="in-conclusion">In conclusion…</h2>
<p>… useful knowledge I’ve gained installing Arch:</p>

<p>– Use of <code>chroot</code>. I hadn’t use that command until I’ve come to install Arch, and it can be very handy in server management and repairing of Linux installations through Live CDs and other already installed systems.</p>

<p>– NVIDIA GTX 860M can be correctly configured in Arch, whereas in Ubuntu 14.04 LTS can’t be.</p>

<p>– Arch doesn’t use <code>init</code> as the initialization daemon. It uses <code>systemd</code> which has, among others, some benefits over the first one:</p>

<ul>
  <li>It’s <em>hotplug capable</em>: that means that if a device, like a hard disk, is plugged in the middle or even after the boot, the system will mount as normal, whereas if <code>init</code> is the handler of initialization that doesn’t work the same way.</li>
</ul>

<p class="fig med"><img src="https://raw.githubusercontent.com/dgiim/blog/gh-pages/images/ubuntu_press_s_to_mount.png" alt="" /></p>

<ul>
  <li>
    <p>It’s easier to configure, because the old <code>tc.sysinit</code> has been split up in several files.</p>
  </li>
  <li>
    <p>It handles daemons better.</p>
  </li>
  <li>
    <p>It’s a <em>cross-distro-project</em> which developers of lots of distros have been working on. And the <code>systemd</code> scripts will be distributed all the same for whatever distro we’re talking about, whereas in the older times, each distro had its own <code>rc scripts</code>.</p>
  </li>
  <li>
    <p>It’s supposed to be faster.</p>
  </li>
</ul>


    

    

    <div class="share">
      <a class="dsq-comment-count" href="/blog/2015/03/15/arch/#disqus_thread"></a>
      <a href="https://twitter.com/intent/tweet?url=http://dgiim.github.io/blog//2015/03/15/arch&text=Learning from Arch Linux" class="share-twt" target="_blank"><img alt="Twitter" title="Compartir en Twitter" src="/blog/assets/sq_twitter.png" /></a>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://dgiim.github.io/blog//2015/03/15/arch" class="share-fb" target="_blank"><img alt="Facebook" title="Compartir en Facebook" src="/blog/assets/sq_facebook.png" /></a>
      <a href="http://sharetodiaspora.github.io/?url=http://dgiim.github.io/blog//2015/03/15/arch&title=Learning from Arch Linux" class="share-di" target="_blank"><img alt="Diaspora" title="Compartir en Diaspora*" src="/blog/assets/sq_diaspora.png" /></a>
      <a href="http://www.feedly.com/home#subscription/feed/http://dgiim.github.io/blog/feed.xml" class="share-fd" target="_blank"><img alt="Feedly" title="Suscribirse con Feedly" src="/blog/assets/sq_feedly.png" /></a>
    </div>

  </div>

  <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
</div>

  <div class="pure-g">
    <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 pure-u-lg-3-5">
      <div id="disqus_thread"></div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
  </div>
  <script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'dgiim'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

</article>

      <footer class="pure-g">
    <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
    <div class="pure-u-22-24 pure-u-md-22-24 pure-u-lg-3-5">
      <div class="pure-g">
		<div class="pure-u-1 pure-u-md-1-3 pure-u-lg-1-3">
			<h3>Colaboradores</h3>
	        <ul>
				
					
					<li><a href="http://github.com/fdavidcl">David Charte</a></li>
				
					
					<li><a href="http://github.com/M42">Mario Román</a></li>
				
					
					<li><a href="http://github.com/pbaeyens">Pablo Baeyens</a></li>
				
					
					<li><a href="http://github.com/NCordon">Ignacio Cordón</a></li>
				
					
					<li><a href="http://github.com/andreshp">Andrés Herrera Poyatos</a></li>
				
					
					<li><a href="http://github.com/oxcar103">Óscar Bermúdez</a></li>
				
	        </ul>
		</div>
        <div class="pure-u-1 pure-u-md-1-3 pure-u-lg-1-3">
			<h3>Categorías</h3>
	        <ul>
		    	
		            <li><a href="/blog/categories/#utilidades">Utilidades</a></li>
		    	
		            <li><a href="/blog/categories/#análisis">Análisis</a></li>
		    	
		            <li><a href="/blog/categories/#programación">Programación</a></li>
		    	
		            <li><a href="/blog/categories/#Álgebra">Álgebra</a></li>
		    	
		            <li><a href="/blog/categories/#ciencia de datos">Ciencia de datos</a></li>
		    	
		            <li><a href="/blog/categories/#heurísticas">Heurísticas</a></li>
		    	
		            <li><a href="/blog/categories/#problemas">Problemas</a></li>
		    	
		            <li><a href="/blog/categories/#lógica">Lógica</a></li>
		    	
		            <li><a href="/blog/categories/#linux">Linux</a></li>
		    	
	        </ul>
		</div>
        <div class="pure-u-1 pure-u-md-1-3 pure-u-lg-1-3">
			<h3>Licencia</h3>
			<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Licencia de Creative Commons" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" /></a><br />
			El contenido de este blog, salvo que se explicite lo contrario, está bajo una <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">licencia de Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional</a>.
		</div>
      </div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-24 pure-u-lg-1-5"></div>
</footer>

      <script type="text/javascript">
         /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
         var disqus_shortname = 'dgiim'; // required: replace example with your forum shortname

         /* * * DON'T EDIT BELOW THIS LINE * * */
         (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
         }());
      </script>
   </body>
</html>
